<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>World Time Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/css/bootstrap.min.css" integrity="sha512-jnSuA4Ss2PkkikSOLtYs8BlYIeeIK1h99ty4YfvRPAlzr377vr3CXDb7sb7eEEBYjDtcYj+AjBH3FLv5uSJuXg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.5.13/vue.global.prod.min.js" integrity="sha512-66fV4MXSQdGN0KQxZ0Bw627HalhTQYQbOoF24EtMXN2FaAoKMgAZ7nDi77d9xWwrRjEEUfE+7rxjTt+cA2IuJA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.6/Sortable.min.js" integrity="sha512-csIng5zcB+XpulRUa+ev1zKo7zRNGpEaVfNB9On1no9KYTEY/rLGAEEpvgdw6nim1WdTuihZY1eqZ31K7/fZjw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment-with-locales.min.js" integrity="sha512-42PE0rd+wZ2hNXftlM78BSehIGzezNeQuzihiBCvUEB3CVxHvsShF86wBWwQORNxNINlBPuq7rG4WWhNiTVHFg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment-timezone/0.5.46/moment-timezone-with-data.min.js" integrity="sha512-4MAP/CJtK3ASCmbYjYxWAbHWASAx1UYMc1i83cBdQZXegqFfqSZ9WqpmkRGfvzeAI18yvKiDTlgX/TLNMpxkSQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
        // Run this before page renders to set initial theme
        (function() {
            const savedTheme = localStorage.getItem('isDarkTheme');
            const initialTheme = savedTheme !== null ? savedTheme === 'true' : true;
            document.documentElement.setAttribute('data-theme', initialTheme ? 'dark' : 'light');
        })();
    </script>
    <style>
        :root {
            --bg-color: #f8f9fa;
            --tile-gradient-1: #ffffff;
            --tile-gradient-2: #f0f0f0;
            --text-primary: #2c3e50;
            --text-secondary: #7f8c8d;
            --text-header: #34495e;
            --shadow-color: rgba(0,0,0,0.1);
            --shadow-hover: rgba(0,0,0,0.15);
        }

        [data-theme="dark"] {
            --bg-color: #1a1a1a;
            --tile-gradient-1: #2d2d2d;
            --tile-gradient-2: #252525;
            --text-primary: #ffffff;
            --text-secondary: #b0b0b0;
            --text-header: #ffffff;
            --shadow-color: rgba(0,0,0,0.3);
            --shadow-hover: rgba(0,0,0,0.4);
        }

        body {
            background-color: var(--bg-color);
            transition: background-color 0.3s ease;
        }

        .time-tile {
            background: linear-gradient(145deg, var(--tile-gradient-1), var(--tile-gradient-2));
            border-radius: 15px;
            box-shadow: 5px 5px 15px var(--shadow-color);
            transition: all 0.3s ease;
            cursor: move;
            max-width: 320px;
            margin: 0 auto;
        }

        .time-tile:hover {
            transform: translateY(-5px);
            box-shadow: 7px 7px 20px var(--shadow-hover);
        }

        .time {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .date {
            color: var(--text-secondary);
        }

        .location {
            color: var(--text-header);
            font-weight: 600;
            font-size: 1.1rem;
        }

        .country {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .theme-switch {
            position: fixed;
            top: 1rem;
            right: 1rem;
            z-index: 1000;
        }

        .theme-switch-button {
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 50%;
            transition: all 0.3s ease;
            background: var(--tile-gradient-1);
            box-shadow: 2px 2px 5px var(--shadow-color);
        }

        .theme-switch-button:hover {
            transform: scale(1.1);
        }

        h1 {
            color: var(--text-primary);
        }

        .sortable-ghost {
            opacity: 0.5;
            background: #c8ebfb;
        }
        @media (max-width: 768px) {
            .time {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body :class="{ 'bg-light': !isDarkTheme }" :data-theme="isDarkTheme ? 'dark' : 'light'">
    <div id="app">
        <div class="theme-switch">
            <button class="theme-switch-button" @click="toggleTheme">
                <i :class="isDarkTheme ? 'fas fa-sun' : 'fas fa-moon'"></i>
            </button>
        </div>
        <div class="container py-4">
            <h1 class="text-center mb-4">
                <i class="fas fa-globe me-2"></i>
                World Time Dashboard
            </h1>
            <div class="row g-4" ref="timeGrid">
                <div v-for="(zone, index) in timeZones" 
                     :key="zone"
                     class="col-12 col-md-6 col-lg-4">
                    <div class="time-tile p-4">
                        <div class="location mb-1">
                            <i class="fas fa-map-marker-alt me-2"></i>
                            {{ formatLocation(zone) }}
                        </div>
                        <div class="country mb-2">{{ getCountry(zone) }}</div>
                        <div class="time">{{ getTime(zone) }}</div>
                        <div class="date">{{ getDate(zone) }}</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const { createApp } = Vue;
        const app = createApp({
            data() {
                return {
                    timeZones: [
                        "UTC",
                        "America/New_York",
                        "America/Los_Angeles",
                        "America/Chicago",
                        "America/Sao_Paulo",
                        "Europe/London",
                        "Europe/Paris",
                        "Europe/Moscow",
                        "Africa/Cairo",
                        "Asia/Dubai",
                        "Asia/Kolkata",
                        "Asia/Singapore",
                        "Asia/Tokyo",
                        "Australia/Sydney"
                    ],
                    timer: null,
                    isDarkTheme: localStorage.getItem('isDarkTheme') !== null 
                        ? localStorage.getItem('isDarkTheme') === 'true' 
                        : true
                };
            },
            methods: {
                getTime(zone) {
                    return moment().tz(zone).format('hh:mm:ss A');
                },
                getDate(zone) {
                    return moment().tz(zone).format('ddd, MMM D, YYYY');
                },
                formatLocation(zone) {
                    return zone.replace('_', ' ').split('/').pop();
                },
                getCountry(zone) {
                    const countries = {
                        'UTC': 'Coordinated Universal Time',
                        'America/New_York': 'United States',
                        'America/Los_Angeles': 'United States',
                        'America/Chicago': 'United States',
                        'America/Sao_Paulo': 'Brazil',
                        'Europe/London': 'United Kingdom',
                        'Europe/Paris': 'France',
                        'Europe/Moscow': 'Russia',
                        'Africa/Cairo': 'Egypt',
                        'Asia/Dubai': 'United Arab Emirates',
                        'Asia/Kolkata': 'India',
                        'Asia/Singapore': 'Singapore',
                        'Asia/Tokyo': 'Japan',
                        'Australia/Sydney': 'Australia'
                    };
                    return countries[zone] || zone.split('/')[0];
                },
                saveOrder() {
                    localStorage.setItem('timeZoneOrder', JSON.stringify(this.timeZones));
                },
                loadOrder() {
                    const saved = localStorage.getItem('timeZoneOrder');
                    if (saved) {
                        this.timeZones = JSON.parse(saved);
                    }
                },
                toggleTheme() {
                    this.isDarkTheme = !this.isDarkTheme;
                    document.documentElement.setAttribute('data-theme', this.isDarkTheme ? 'dark' : 'light');
                    localStorage.setItem('isDarkTheme', this.isDarkTheme);
                },
                loadTheme() {
                    const savedTheme = localStorage.getItem('isDarkTheme');
                    if (savedTheme !== null) {
                        this.isDarkTheme = savedTheme === 'true';
                    } else {
                        this.isDarkTheme = true;
                        localStorage.setItem('isDarkTheme', 'true');
                    }
                    document.documentElement.setAttribute('data-theme', this.isDarkTheme ? 'dark' : 'light');
                }
            },
            mounted() {
                this.loadOrder();
                this.loadTheme();
                this.timer = setInterval(() => {
                    this.$forceUpdate();
                }, 1000);

                new Sortable(this.$refs.timeGrid, {
                    animation: 150,
                    onEnd: (evt) => {
                        const itemEl = evt.item;
                        const newIndex = evt.newIndex;
                        const oldIndex = evt.oldIndex;
                        
                        const item = this.timeZones.splice(oldIndex, 1)[0];
                        this.timeZones.splice(newIndex, 0, item);
                        
                        this.saveOrder();
                    }
                });
            },
            beforeDestroy() {
                if (this.timer) {
                    clearInterval(this.timer);
                }
            }
        }).mount('#app');
    </script>
</body>
</html>
